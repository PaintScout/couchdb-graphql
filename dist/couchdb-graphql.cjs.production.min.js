"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var n,t=require("apollo-server-core"),e=(n=require("qs"))&&"object"==typeof n&&"default"in n?n.default:n,r=require("@graphql-modules/core");function o(n,t,e,r,o,i,s){try{var a=n[i](s),u=a.value}catch(n){return void e(n)}a.done?t(u):Promise.resolve(u).then(r,o)}function i(n){return function(){var t=this,e=arguments;return new Promise((function(r,i){var s=n.apply(t,e);function a(n){o(s,r,i,a,u,"next",n)}function u(n){o(s,r,i,a,u,"throw",n)}a(void 0)}))}}function s(){return(s=Object.assign||function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n}).apply(this,arguments)}function a(n,t){if(null==n)return{};var e,r,o={},i=Object.keys(n);for(r=0;r<i.length;r++)t.indexOf(e=i[r])>=0||(o[e]=n[e]);return o}function u(n,t){return t||(t=n.slice(0)),n.raw=t,n}function c(){var n=u(["\n    scalar JSON\n\n    type Query\n    type Mutation\n  "]);return c=function(){return n},n}require("isomorphic-fetch");var l,p={typeDefs:t.gql(c())},f=(function(n){var t=function(n){var t,e=Object.prototype,r=e.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",a=o.toStringTag||"@@toStringTag";function u(n,t,e){return Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}),n[t]}try{u({},"")}catch(n){u=function(n,t,e){return n[t]=e}}function c(n,t,e,r){var o=Object.create((t&&t.prototype instanceof v?t:v).prototype),i=new I(r||[]);return o._invoke=function(n,t,e){var r=p;return function(o,i){if(r===d)throw new Error("Generator is already running");if(r===h){if("throw"===o)throw i;return J()}for(e.method=o,e.arg=i;;){var s=e.delegate;if(s){var a=O(s,e);if(a){if(a===y)continue;return a}}if("next"===e.method)e.sent=e._sent=e.arg;else if("throw"===e.method){if(r===p)throw r=h,e.arg;e.dispatchException(e.arg)}else"return"===e.method&&e.abrupt("return",e.arg);r=d;var u=l(n,t,e);if("normal"===u.type){if(r=e.done?h:f,u.arg===y)continue;return{value:u.arg,done:e.done}}"throw"===u.type&&(r=h,e.method="throw",e.arg=u.arg)}}}(n,e,i),o}function l(n,t,e){try{return{type:"normal",arg:n.call(t,e)}}catch(n){return{type:"throw",arg:n}}}n.wrap=c;var p="suspendedStart",f="suspendedYield",d="executing",h="completed",y={};function v(){}function _(){}function g(){}var m={};m[i]=function(){return this};var k=Object.getPrototypeOf,b=k&&k(k(B([])));b&&b!==e&&r.call(b,i)&&(m=b);var w=g.prototype=v.prototype=Object.create(m);function x(n){["next","throw","return"].forEach((function(t){u(n,t,(function(n){return this._invoke(t,n)}))}))}function S(n,t){var e;this._invoke=function(o,i){function s(){return new t((function(e,s){!function e(o,i,s,a){var u=l(n[o],n,i);if("throw"!==u.type){var c=u.arg,p=c.value;return p&&"object"==typeof p&&r.call(p,"__await")?t.resolve(p.__await).then((function(n){e("next",n,s,a)}),(function(n){e("throw",n,s,a)})):t.resolve(p).then((function(n){c.value=n,s(c)}),(function(n){return e("throw",n,s,a)}))}a(u.arg)}(o,i,e,s)}))}return e=e?e.then(s,s):s()}}function O(n,e){var r=n.iterator[e.method];if(r===t){if(e.delegate=null,"throw"===e.method){if(n.iterator.return&&(e.method="return",e.arg=t,O(n,e),"throw"===e.method))return y;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return y}var o=l(r,n.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,y;var i=o.arg;return i?i.done?(e[n.resultName]=i.value,e.next=n.nextLoc,"return"!==e.method&&(e.method="next",e.arg=t),e.delegate=null,y):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,y)}function N(n){var t={tryLoc:n[0]};1 in n&&(t.catchLoc=n[1]),2 in n&&(t.finallyLoc=n[2],t.afterLoc=n[3]),this.tryEntries.push(t)}function D(n){var t=n.completion||{};t.type="normal",delete t.arg,n.completion=t}function I(n){this.tryEntries=[{tryLoc:"root"}],n.forEach(N,this),this.reset(!0)}function B(n){if(n){var e=n[i];if(e)return e.call(n);if("function"==typeof n.next)return n;if(!isNaN(n.length)){var o=-1,s=function e(){for(;++o<n.length;)if(r.call(n,o))return e.value=n[o],e.done=!1,e;return e.value=t,e.done=!0,e};return s.next=s}}return{next:J}}function J(){return{value:t,done:!0}}return _.prototype=w.constructor=g,g.constructor=_,_.displayName=u(g,a,"GeneratorFunction"),n.isGeneratorFunction=function(n){var t="function"==typeof n&&n.constructor;return!!t&&(t===_||"GeneratorFunction"===(t.displayName||t.name))},n.mark=function(n){return Object.setPrototypeOf?Object.setPrototypeOf(n,g):(n.__proto__=g,u(n,a,"GeneratorFunction")),n.prototype=Object.create(w),n},n.awrap=function(n){return{__await:n}},x(S.prototype),S.prototype[s]=function(){return this},n.AsyncIterator=S,n.async=function(t,e,r,o,i){void 0===i&&(i=Promise);var s=new S(c(t,e,r,o),i);return n.isGeneratorFunction(e)?s:s.next().then((function(n){return n.done?n.value:s.next()}))},x(w),u(w,a,"Generator"),w[i]=function(){return this},w.toString=function(){return"[object Generator]"},n.keys=function(n){var t=[];for(var e in n)t.push(e);return t.reverse(),function e(){for(;t.length;){var r=t.pop();if(r in n)return e.value=r,e.done=!1,e}return e.done=!0,e}},n.values=B,I.prototype={constructor:I,reset:function(n){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!n)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=t)},stop:function(){this.done=!0;var n=this.tryEntries[0].completion;if("throw"===n.type)throw n.arg;return this.rval},dispatchException:function(n){if(this.done)throw n;var e=this;function o(r,o){return a.type="throw",a.arg=n,e.next=r,o&&(e.method="next",e.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],a=s.completion;if("root"===s.tryLoc)return o("end");if(s.tryLoc<=this.prev){var u=r.call(s,"catchLoc"),c=r.call(s,"finallyLoc");if(u&&c){if(this.prev<s.catchLoc)return o(s.catchLoc,!0);if(this.prev<s.finallyLoc)return o(s.finallyLoc)}else if(u){if(this.prev<s.catchLoc)return o(s.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return o(s.finallyLoc)}}}},abrupt:function(n,t){for(var e=this.tryEntries.length-1;e>=0;--e){var o=this.tryEntries[e];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===n||"continue"===n)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var s=i?i.completion:{};return s.type=n,s.arg=t,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(s)},complete:function(n,t){if("throw"===n.type)throw n.arg;return"break"===n.type||"continue"===n.type?this.next=n.arg:"return"===n.type?(this.rval=this.arg=n.arg,this.method="return",this.next="end"):"normal"===n.type&&t&&(this.next=t),y},finish:function(n){for(var t=this.tryEntries.length-1;t>=0;--t){var e=this.tryEntries[t];if(e.finallyLoc===n)return this.complete(e.completion,e.afterLoc),D(e),y}},catch:function(n){for(var t=this.tryEntries.length-1;t>=0;--t){var e=this.tryEntries[t];if(e.tryLoc===n){var r=e.completion;if("throw"===r.type){var o=r.arg;D(e)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(n,e,r){return this.delegate={iterator:B(n),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=t),y}},n}(n.exports);try{regeneratorRuntime=t}catch(n){Function("r","regeneratorRuntime = r")(t)}}(l={exports:{}}),l.exports);function d(n){return n}function h(n){return y.apply(this,arguments)}function y(){return(y=i(f.mark((function n(t){var e;return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(t.status>=200&&t.status<300)){n.next=4;break}return n.abrupt("return",t.json());case 4:return e=new Error(t.statusText),n.next=7,t.json();case 7:throw e.response=n.sent,e;case 9:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function v(n,t){return _.apply(this,arguments)}function _(){return(_=i(f.mark((function n(t,e){var r,o,i,a,u,c,l;return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o=(r=e.couchDb).fetch,i=r.dbUrl,a=r.dbName,n.next=3,o(i+"/"+a+"/_all_docs?conflicts=true&include_docs=true",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({keys:t.map((function(n){return n._id}))})}).then(h).then((function(n){return n.rows.map((function(n){return n.doc})).filter((function(n){return!!n}))}));case 3:return u=n.sent,n.next=6,o(i+"/"+a+"/_bulk_get",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({docs:u.reduce((function(n,t){return[].concat(n,(t&&t._conflicts||[]).map((function(n){return{id:t._id,rev:n}})))}),[])})}).then(h).then((function(n){return n.results.map((function(n){return n.docs[0].ok})).filter((function(n){return!!n}))}));case 6:return c=n.sent,l=u.reduce((function(n,e){if(!n[e._id]){var r=u.find((function(n){return n._id===e._id}));n[e._id]={document:t.find((function(n){return n._id===e._id})),conflicts:[e],revToSave:r._rev}}var o,i=c.filter((function(n){return n._id===e._id}));return i?s({},n,((o={})[e._id]=s({},n[e._id],{conflicts:[].concat(n[e._id].conflicts,i)}),o)):n}),{}),n.abrupt("return",l);case 9:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function g(n,t){return m.apply(this,arguments)}function m(){return(m=i(f.mark((function n(t,e){var r,o,u,c,l,p,d,y,_,g,m;return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=(r=e.couchDb).fetch,u=r.dbName,c=r.dbUrl,p=r.onConflictsResolved,l=r.onResolveConflict){n.next=3;break}return n.abrupt("return",null);case 3:return n.next=5,v(t,e);case 5:return d=n.sent,n.next=8,Promise.all(Object.keys(d).map(function(){var n=i(f.mark((function n(t){var r,o;return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,l({document:d[t].document,conflicts:d[t].conflicts,context:e});case 2:if(!(r=n.sent)){n.next=6;break}return o=a(r,["_conflicts"]),n.abrupt("return",s({},o,{_rev:d[t].revToSave}));case 6:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}())).then((function(n){return n.filter(Boolean)}));case 8:return _=[].concat(y=n.sent,Object.keys(d).reduce((function(n,t){return[].concat(n,d[t].conflicts.map((function(n){return s({},n,{_deleted:!0})})).filter((function(n){return n._rev!==d[t].revToSave})))}),[])),n.next=12,o(c+"/"+u+"/_bulk_docs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({docs:_})}).then(h);case 12:return m=(g=n.sent).filter((function(n){return n.ok})).map((function(n){return s({},_.find((function(t){return t._id===n.id})),{_rev:n.rev,_id:n.id})})),p&&m.length>0&&p({documents:m,context:e}),n.abrupt("return",g.map((function(n,t){return s({},y[t],{_id:n.id,_rev:n.rev})})));case 16:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function k(n,t,e){return b.apply(this,arguments)}function b(){return(b=i(f.mark((function n(t,e,r){var o,a,u,c,l,p,d,y,v,_,m,k,b,w;return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(void 0===r&&(r={}),u=(a=t.couchDb).fetch,p=a.onDocumentsSaved,y=(d=r).upsert,_=void 0===(v=d.new_edits)||v,m=(c=a.dbUrl)+"/"+(l=a.dbName)+"/_bulk_docs",k=null!=(o=e._rev)?o:void 0,null===e._deleted&&delete e._deleted,!y){n.next=22;break}if(e._id){n.next=9;break}throw Error("upsert option requires input to contain _id");case 9:return n.prev=9,n.next=12,u(c+"/"+l+"/"+encodeURIComponent(e._id)).then(h);case 12:k=n.sent._rev,n.next=22;break;case 17:if(n.prev=17,n.t0=n.catch(9),n.t0._id=e._id,n.t0.response&&404===n.t0.response.status){n.next=22;break}throw n.t0;case 22:return n.next=24,u(m,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({docs:[s({},e,{_rev:k})],new_edits:_})}).then(h).then(function(){var n=i(f.mark((function n(r){var o,i;return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(o=Array.isArray(r)?r[0]:r)||!o.id||"conflict"!==o.error){n.next=8;break}return n.next=4,g([e],t);case 4:if(!(i=n.sent[0])){n.next=8;break}return n.abrupt("return",i);case 8:throw new Error("blasdkjhf");case 9:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}()).catch((function(n){var t;throw n.stack=new Error(n.message).stack+(null!=(t=n.stack)?t:""),n._id=e._id,n}));case 24:if(!(b=n.sent)||!b.error){n.next=29;break}throw(w=new Error(b.reason))._id=e._id,w;case 29:if(!b){n.next=34;break}return p&&p({documents:[b],context:t}),n.abrupt("return",b);case 34:return n.abrupt("return",null);case 35:case"end":return n.stop()}}),n,null,[[9,17]])})))).apply(this,arguments)}function w(){var n=u(["\n  type PutResponse {\n    _id: String!\n    _rev: String\n    document: JSON\n  }\n\n  extend type Mutation {\n    put(input: JSON, upsert: Boolean, new_edits: Boolean): PutResponse\n  }\n"]);return w=function(){return n},n}function x(n,t,e){return S.apply(this,arguments)}function S(){return(S=i(f.mark((function n(t,e,r){var o,a,u,c,l,p,d,y,v,_,m,k,b;return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(void 0===r&&(r={}),a=(o=t.couchDb).fetch,l=o.onDocumentsSaved,v=void 0===(y=(p=r).new_edits)||y,_=(u=o.dbUrl)+"/"+(c=o.dbName)+"/_bulk_docs",m={},!(d=p.upsert)){n.next=12;break}return k=e.map((function(n){return n._id})).filter((function(n){return!!n})),n.next=9,a(u+"/"+c+"/_all_docs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({keys:k})}).then(h);case 9:n.sent.data.rows.forEach((function(n){m[n.id]=n.value?n.value.rev:null}));case 12:return n.next=14,a(_,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({docs:e.map((function(n){var t,e=s({},n,{_rev:null!=(t=d&&n._id?m[n._id]:n._rev)?t:void 0});return null===e._deleted&&delete e._deleted,e})),new_edits:v})}).then(h).then(function(){var n=i(f.mark((function n(r){var o,i;return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!((o=r.filter((function(n){return"conflict"===n.error}))).length>0)){n.next=7;break}return n.next=4,g(e.filter((function(n){return o.find((function(t){return t.id===n._id}))})),t);case 4:if(!(i=n.sent)){n.next=7;break}return n.abrupt("return",r.map((function(n){var t=i.find((function(t){return t.id===n.id}));return"conflict"===n.error&&t?t:n})));case 7:return n.abrupt("return",r);case 8:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}()).catch((function(n){var t;throw n.stack=new Error(n.message).stack+(null!=(t=n.stack)?t:""),n.ids=e.map((function(n){return n._id})),n}));case 14:return b=n.sent.map((function(n,t){var r=e[t],o=n.error?m[r._id]||r._rev:n.rev;return{_id:n.id,_rev:o,error:n.error,reason:n.reason,document:s({},r,{_id:n.id,_rev:o})}})),l&&l({documents:b.filter((function(n){return!n.error})).map((function(n){return n.document})),context:t}),n.abrupt("return",b);case 18:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function O(){var n=u(["\n  type BulkDocsResponseObject {\n    _id: String\n    _rev: String\n    document: JSON\n    error: String\n    reason: String\n  }\n\n  extend type Mutation {\n    bulkDocs(\n      input: [JSON!]!\n      upsert: Boolean\n      new_edits: Boolean\n    ): [BulkDocsResponseObject]\n  }\n"]);return O=function(){return n},n}var N={__proto__:null,put:{__proto__:null,typeDefs:t.gql(w()),resolvers:{Mutation:{put:d(function(){var n=i(f.mark((function n(t,e,r,o){var i,s,a,u,c;return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=e.input,s=e.upsert,u=void 0===(a=e.new_edits)||a,n.next=3,k(r,i,{upsert:s,new_edits:u});case 3:return n.abrupt("return",{_id:(c=n.sent)._id,_rev:c._rev,document:c});case 5:case"end":return n.stop()}}),n)})));return function(t,e,r,o){return n.apply(this,arguments)}}())}}},bulkDocs:{__proto__:null,typeDefs:t.gql(O()),resolvers:{Mutation:{bulkDocs:d((function(n,t,e,r){var o=t.new_edits;return x(e,t.input,{upsert:t.upsert,new_edits:void 0===o||o})}))}}}};function D(n,t){return I.apply(this,arguments)}function I(){return(I=i(f.mark((function n(t,r){var o,i,s,u,c,l,p,d;return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=(o=void 0===r?{}:r).keys,s=o.key,u=o.endkey,c=o.startkey,l=a(o,["keys","key","endkey","startkey"]),p=t.couchDb.fetch,d=t.couchDb.dbUrl+"/"+t.couchDb.dbName+"/_all_docs",l&&(d+="?"+e.stringify(l)),n.next=6,p(d,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({keys:i,key:s,endkey:u,startkey:c})}).then(h).catch((function(n){var t;throw n.stack=new Error(n.message).stack+(null!=(t=n.stack)?t:""),n.body=JSON.stringify({keys:i,key:s,endkey:u,startkey:c}),n}));case 6:return n.abrupt("return",n.sent);case 8:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function B(){var n=u(["\n  type AllDocsRow {\n    id: String!\n    rev: String\n    value: JSON\n    doc: JSON\n  }\n\n  type AllDocsResponse {\n    total_rows: Int!\n    offset: Int!\n    rows: [AllDocsRow!]!\n  }\n\n  extend type Query {\n    allDocs(\n      conflicts: Boolean\n      endkey: JSON\n      include_docs: Boolean\n      inclusive_end: Boolean\n      key: JSON\n      keys: [JSON!]\n      limit: Int\n      skip: Int\n      startkey: JSON\n      update_seq: Boolean\n    ): AllDocsResponse\n  }\n"]);return B=function(){return n},n}var J={__proto__:null,typeDefs:t.gql(B()),resolvers:{Query:{allDocs:d((function(n,t,e,r){return D(e,t)}))}}};function E(n,t,e){return j.apply(this,arguments)}function j(){return(j=i(f.mark((function n(t,r,o){var i,s,a,u;return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=(s=r.couchDb).fetch,u=s.dbUrl+"/"+s.dbName+"/_bulk_get",(i=(void 0===o?{}:o).revs)&&(u+="?"+e.stringify({revs:i})),n.next=6,a(u,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({docs:t,revs:i})}).then(h).catch((function(n){throw n.stack=new Error(n.messae).stack,n.body=JSON.stringify({docs:t,revs:i}),n}));case 6:return n.abrupt("return",n.sent);case 8:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function R(){var n=u(["\n  input BulkGetInput {\n    id: String!\n    rev: String\n  }\n\n  type BulkGetResponse {\n    results: [BulkGetResult!]!\n  }\n\n  type BulkGetResult {\n    id: String\n    docs: [BulkGetDocs!]!\n  }\n\n  type BulkGetDocs {\n    ok: JSON\n    error: BulkGetError\n  }\n\n  type BulkGetError {\n    id: String\n    rev: String\n    error: String\n    reason: String\n  }\n\n  extend type Query {\n    bulkGet(docs: [BulkGetInput!]!, revs: Boolean): BulkGetResponse\n  }\n"]);return R=function(){return n},n}var q={__proto__:null,typeDefs:t.gql(R()),resolvers:{Query:{bulkGet:d((function(n,t,e,r){return E(t.docs,e,{revs:t.revs})}))}}};function T(n,t){return L.apply(this,arguments)}function L(){return(L=i(f.mark((function n(t,r){var o,i,s;return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o=t.couchDb.fetch,i=Object.keys(r).length>0,s=t+"/"+t+"/_changes",i&&(r.lastEventId&&(delete r.lastEventId,r["last-event-id"]=r.lastEventId),r.since&&"now"!==r.since&&(r.since=parseInt(r.since)),s+="?"+e.stringify(r)),n.next=6,o(s).then(h).catch((function(n){var t;throw n.stack=new Error(n.message).stack+(null!=(t=n.stack)?t:""),n}));case 6:return n.abrupt("return",n.sent);case 8:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function C(){var n=u(["\n  type Change {\n    rev: String\n  }\n  type ChangesResult {\n    changes: [Change]\n    id: String\n    seq: JSON\n    doc: JSON\n    deleted: Boolean\n  }\n\n  type ChangesResponse {\n    last_seq: JSON\n    pending: Int\n    results: [ChangesResult]\n  }\n\n  extend type Query {\n    changes(\n      doc_ids: [String!]\n      conflicts: Boolean\n      descending: Boolean\n      feed: String\n      filter: String\n      heartbeat: Int\n      include_docs: Boolean\n      attachments: Boolean\n      att_encoding_info: Boolean\n      lastEventId: Int\n      limit: Int\n      since: String\n      timeout: Int\n      view: String\n      seq_interval: Int\n    ): ChangesResponse\n  }\n"]);return C=function(){return n},n}var G={__proto__:null,typeDefs:t.gql(C()),resolvers:{Query:{changes:d((function(n,t,e,r){return T(e,t)}))}}};function P(n,t){return Q.apply(this,arguments)}function Q(){return(Q=i(f.mark((function n(t,e){var r,o,i;return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o=(r=t.couchDb).fetch,i=r.dbUrl+"/"+r.dbName+"/_find",n.next=4,o(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(h).catch((function(n){var t;throw n.stack=new Error(n.message).stack+(null!=(t=n.stack)?t:""),n.body=JSON.stringify(e),n}));case 4:return n.abrupt("return",n.sent);case 6:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function U(n,t,e){return A.apply(this,arguments)}function A(){return(A=i(f.mark((function n(t,r,o){var i,s,a,u,c,l;return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(void 0===o&&(o={}),s=(i=t.couchDb).fetch,a=i.dbUrl,u=i.dbName,c=Object.keys(o).length>0,r){n.next=5;break}throw new Error("id is undefined");case 5:return l=a+"/"+u+"/"+encodeURIComponent(r),c&&(l+="?"+e.stringify(o)),n.next=9,s(l).then(h).catch((function(n){var t;throw n._id=r,n.stack=new Error(n.message).stack+(null!=(t=n.stack)?t:""),n}));case 9:return n.abrupt("return",n.sent);case 11:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function F(n){return M.apply(this,arguments)}function M(){return(M=i(f.mark((function n(t){var e,r,o;return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=(e=t.couchDb).fetch,o=e.dbUrl+"/"+e.dbName,n.next=4,r(o).then(h).catch((function(n){var t;throw n.stack=new Error(n.message).stack+(null!=(t=n.stack)?t:""),n}));case 4:return n.abrupt("return",n.sent);case 6:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function z(n,t){return Y.apply(this,arguments)}function Y(){return(Y=i(f.mark((function n(t,r){var o,i,s,u,c,l,p,d,y,v,_;return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o=r.view,i=r.ddoc,s=r.key,u=r.keys,c=a(r,["view","ddoc","key","keys"]),p=(l=t.couchDb).fetch,d={key:s,keys:u},y=l.dbUrl+"/"+l.dbName+"/_design/"+i+"/_view/"+o,c&&(y+="?"+e.stringify(c)),v=Object.keys(d).length>0,_={},v&&(_.method="POST",_.body=JSON.stringify(d),_.headers={Accept:"application/json","Content-Type":"application/json"}),n.next=10,p(y,_).then(h).catch((function(n){var t;throw n.stack=new Error(n.message).stack+(null!=(t=n.stack)?t:""),n.body=_.body,n}));case 10:return n.abrupt("return",n.sent);case 12:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function H(n,t){return K.apply(this,arguments)}function K(){return(K=i(f.mark((function n(t,e){var r,o,i,s,u,c;return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=e.index,o=e.ddoc,i=a(e,["index","ddoc"]),u=(s=t.couchDb).fetch,c=s.dbUrl+"/"+s.dbName+"/_design/"+o+"/_search/"+r,n.next=5,u(c,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)}).then(h).catch((function(n){var t;throw n.stack=new Error(n.message).stack+(null!=(t=n.stack)?t:""),n.body=JSON.stringify(i),n}));case 5:return n.abrupt("return",n.sent);case 7:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function V(){return(V=i(f.mark((function n(t){var e,r,o;return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=(e=t.couchDb).fetch,o=e.dbUrl+"/"+e.dbName,n.next=4,r(o,{method:"PUT"}).then(h).catch((function(n){var t;throw n.stack=new Error(n.message).stack+(null!=(t=n.stack)?t:""),n}));case 4:return n.abrupt("return",n.sent);case 6:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function W(){var n=u(["\n  type FindResponse {\n    execution_stats: JSON\n    bookmark: String\n    warning: String\n    docs: [JSON!]\n  }\n\n  extend type Query {\n    find(\n      selector: JSON!\n      limit: Int\n      skip: Int\n      sort: Int\n      fields: [String!]\n      use_index: [String!]\n      r: Int\n      bookmark: String\n      update: Boolean\n      stable: Boolean\n      stale: String\n      execution_stats: Boolean\n    ): FindResponse\n  }\n"]);return W=function(){return n},n}var X={__proto__:null,typeDefs:t.gql(W()),resolvers:{Query:{find:d((function(n,t,e,r){return P(e,t)}))}}};function Z(){var n=u(["\n  type GetResponse {\n    _id: String!\n    _rev: String\n    document: JSON\n  }\n\n  extend type Query {\n    get(\n      id: String!\n      rev: String\n      revs: Boolean\n      revs_info: Boolean\n      open_revs: Boolean\n      conflicts: Boolean\n      attachments: Boolean\n      latest: Boolean\n    ): GetResponse\n  }\n"]);return Z=function(){return n},n}var $={__proto__:null,typeDefs:t.gql(Z()),resolvers:{Query:{get:d(function(){var n=i(f.mark((function n(t,e,r,o){var i,s,u;return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=e.id,s=a(e,["id"]),n.next=3,U(r,i,s);case 3:return n.abrupt("return",{_id:(u=n.sent)._id,_rev:u._rev,document:u});case 5:case"end":return n.stop()}}),n)})));return function(t,e,r,o){return n.apply(this,arguments)}}())}}};function nn(){var n=u(["\n  type Sizes {\n    file: Int\n    external: Int\n    active: Int\n  }\n\n  type Other {\n    data_size: Int\n  }\n\n  type Cluster {\n    q: Int\n    n: Int\n    w: Int\n    r: Int\n  }\n\n  type InfoResponse {\n    db_name: String\n    update_seq: String\n    sizes: Sizes\n    purge_seq: Int\n    other: Other\n    doc_del_count: Int\n    doc_count: Int\n    disk_size: Int\n    disk_format_version: Int\n    data_size: Int\n    compact_running: Boolean\n    cluster: Cluster\n    instance_start_time: Int\n  }\n\n  extend type Query {\n    info: InfoResponse\n  }\n"]);return nn=function(){return n},n}var tn={__proto__:null,typeDefs:t.gql(nn()),resolvers:{Query:{info:d((function(n,t,e){return F(e)}))}}};function en(){var n=u(["\n  type QueryResponse {\n    offset: Int\n    update_seq: JSON\n    total_rows: Int\n    rows: [QueryRow!]\n  }\n\n  type QueryRow {\n    id: String\n    key: JSON\n    value: JSON\n  }\n\n  extend type Query {\n    query(\n      ddoc: String!\n      view: String!\n      conflicts: Boolean\n      descending: Boolean\n      endkey: JSON\n      group: Boolean\n      group_level: Int\n      include_docs: Boolean\n      attachments: Boolean\n      att_encoding_info: Boolean\n      inclusive_end: Boolean\n      key: JSON\n      keys: [JSON!]\n      limit: Int\n      reduce: Boolean\n      skip: Int\n      sorted: Boolean\n      stable: Boolean\n      stale: String\n      startkey: JSON\n      update: String\n      update_seq: Boolean\n    ): QueryResponse\n  }\n"]);return en=function(){return n},n}var rn={__proto__:null,typeDefs:t.gql(en()),resolvers:{Query:{query:d(function(){var n=i(f.mark((function n(t,e,r,o){return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",z(r,e));case 1:case"end":return n.stop()}}),n)})));return function(t,e,r,o){return n.apply(this,arguments)}}())}}};function on(){var n=u(["\n  type SearchResponse {\n    total_rows: Int!\n    bookmark: String!\n    rows: [SearchRow]!\n    counts: JSON\n  }\n\n  type SearchRow {\n    id: String!\n    order: [Int!]!\n    fields: JSON!\n    doc: JSON\n  }\n\n  extend type Query {\n    search(\n      index: String!\n      ddoc: String!\n      bookmark: String\n      counts: [String!]\n      drilldown: JSON\n      group_field: String\n      group_limit: Int\n      group_sort: JSON\n      highlight_fields: [String!]\n      highlight_pre_tag: String\n      highlight_post_tag: String\n      highlight_number: Int\n      highlight_size: Int\n      include_docs: Boolean\n      include_fields: [String!]\n      limit: Int\n      query: String!\n      ranges: JSON\n      sort: [String!]\n      stale: String\n    ): SearchResponse\n  }\n"]);return on=function(){return n},n}var sn={__proto__:null,get:$,info:tn,bulkGet:q,changes:G,search:{__proto__:null,typeDefs:t.gql(on()),resolvers:{Query:{search:d(function(){var n=i(f.mark((function n(t,e,r,o){return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",H(r,e));case 1:case"end":return n.stop()}}),n)})));return function(t,e,r,o){return n.apply(this,arguments)}}())}}},find:X,query:rn,allDocs:J};exports.allDocs=D,exports.base=p,exports.bulkDocs=x,exports.bulkGet=E,exports.changes=T,exports.createContext=function(n){return{couchDb:s({fetch:fetch},n)}},exports.createCouchDbModule=function(n,t){var e=n.cloudant,o=a(n,["cloudant"]),i=a(sn,["search"]),u=[p.typeDefs].concat(Object.keys(e?sn:i).map((function(n){return sn[n].typeDefs})),Object.keys(N).map((function(n){return N[n].typeDefs})));o.typeDefs&&(Array.isArray(o.typeDefs)?u.push.apply(u,o.typeDefs):u.push(o.typeDefs));var c=[].concat(Object.keys(e?sn:i).map((function(n){return sn[n].resolvers})),Object.keys(N).map((function(n){return N[n].resolvers})));return o.resolvers&&(Array.isArray(o.resolvers)?c.push.apply(c,o.resolvers):c.push(o.resolvers)),new r.GraphQLModule(s({},o,{typeDefs:u,resolvers:c}),t)},exports.createDb=function(n){return V.apply(this,arguments)},exports.createResolver=d,exports.find=P,exports.get=U,exports.info=F,exports.mutations=N,exports.put=k,exports.queries=sn,exports.query=z,exports.resolveConflicts=g,exports.search=H;
//# sourceMappingURL=couchdb-graphql.cjs.production.min.js.map
