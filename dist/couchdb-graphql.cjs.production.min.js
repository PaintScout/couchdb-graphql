"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var n,t=require("apollo-server-core"),e=(n=require("qs"))&&"object"==typeof n&&"default"in n?n.default:n,r=require("@graphql-modules/core");function o(n,t,e,r,o,i,u){try{var c=n[i](u),a=c.value}catch(n){return void e(n)}c.done?t(a):Promise.resolve(a).then(r,o)}function i(n){return function(){var t=this,e=arguments;return new Promise((function(r,i){var u=n.apply(t,e);function c(n){o(u,r,i,c,a,"next",n)}function a(n){o(u,r,i,c,a,"throw",n)}c(void 0)}))}}function u(){return(u=Object.assign||function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n}).apply(this,arguments)}function c(n,t){if(null==n)return{};var e,r,o={},i=Object.keys(n);for(r=0;r<i.length;r++)t.indexOf(e=i[r])>=0||(o[e]=n[e]);return o}function a(n,t){return t||(t=n.slice(0)),n.raw=t,n}function s(){var n=a(["\n    scalar JSON\n\n    type Query\n    type Mutation\n  "]);return s=function(){return n},n}require("isomorphic-fetch");var p,l={typeDefs:t.gql(s())},f=(function(n){var t=function(n){var t,e=Object.prototype,r=e.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",u=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function a(n,t,e){return Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}),n[t]}try{a({},"")}catch(n){a=function(n,t,e){return n[t]=e}}function s(n,t,e,r){var o=Object.create((t&&t.prototype instanceof v?t:v).prototype),i=new I(r||[]);return o._invoke=function(n,t,e){var r=l;return function(o,i){if(r===d)throw new Error("Generator is already running");if(r===h){if("throw"===o)throw i;return E()}for(e.method=o,e.arg=i;;){var u=e.delegate;if(u){var c=O(u,e);if(c){if(c===y)continue;return c}}if("next"===e.method)e.sent=e._sent=e.arg;else if("throw"===e.method){if(r===l)throw r=h,e.arg;e.dispatchException(e.arg)}else"return"===e.method&&e.abrupt("return",e.arg);r=d;var a=p(n,t,e);if("normal"===a.type){if(r=e.done?h:f,a.arg===y)continue;return{value:a.arg,done:e.done}}"throw"===a.type&&(r=h,e.method="throw",e.arg=a.arg)}}}(n,e,i),o}function p(n,t,e){try{return{type:"normal",arg:n.call(t,e)}}catch(n){return{type:"throw",arg:n}}}n.wrap=s;var l="suspendedStart",f="suspendedYield",d="executing",h="completed",y={};function v(){}function _(){}function g(){}var w={};w[i]=function(){return this};var b=Object.getPrototypeOf,m=b&&b(b(B([])));m&&m!==e&&r.call(m,i)&&(w=m);var k=g.prototype=v.prototype=Object.create(w);function x(n){["next","throw","return"].forEach((function(t){a(n,t,(function(n){return this._invoke(t,n)}))}))}function S(n,t){var e;this._invoke=function(o,i){function u(){return new t((function(e,u){!function e(o,i,u,c){var a=p(n[o],n,i);if("throw"!==a.type){var s=a.arg,l=s.value;return l&&"object"==typeof l&&r.call(l,"__await")?t.resolve(l.__await).then((function(n){e("next",n,u,c)}),(function(n){e("throw",n,u,c)})):t.resolve(l).then((function(n){s.value=n,u(s)}),(function(n){return e("throw",n,u,c)}))}c(a.arg)}(o,i,e,u)}))}return e=e?e.then(u,u):u()}}function O(n,e){var r=n.iterator[e.method];if(r===t){if(e.delegate=null,"throw"===e.method){if(n.iterator.return&&(e.method="return",e.arg=t,O(n,e),"throw"===e.method))return y;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return y}var o=p(r,n.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,y;var i=o.arg;return i?i.done?(e[n.resultName]=i.value,e.next=n.nextLoc,"return"!==e.method&&(e.method="next",e.arg=t),e.delegate=null,y):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,y)}function N(n){var t={tryLoc:n[0]};1 in n&&(t.catchLoc=n[1]),2 in n&&(t.finallyLoc=n[2],t.afterLoc=n[3]),this.tryEntries.push(t)}function D(n){var t=n.completion||{};t.type="normal",delete t.arg,n.completion=t}function I(n){this.tryEntries=[{tryLoc:"root"}],n.forEach(N,this),this.reset(!0)}function B(n){if(n){var e=n[i];if(e)return e.call(n);if("function"==typeof n.next)return n;if(!isNaN(n.length)){var o=-1,u=function e(){for(;++o<n.length;)if(r.call(n,o))return e.value=n[o],e.done=!1,e;return e.value=t,e.done=!0,e};return u.next=u}}return{next:E}}function E(){return{value:t,done:!0}}return _.prototype=k.constructor=g,g.constructor=_,_.displayName=a(g,c,"GeneratorFunction"),n.isGeneratorFunction=function(n){var t="function"==typeof n&&n.constructor;return!!t&&(t===_||"GeneratorFunction"===(t.displayName||t.name))},n.mark=function(n){return Object.setPrototypeOf?Object.setPrototypeOf(n,g):(n.__proto__=g,a(n,c,"GeneratorFunction")),n.prototype=Object.create(k),n},n.awrap=function(n){return{__await:n}},x(S.prototype),S.prototype[u]=function(){return this},n.AsyncIterator=S,n.async=function(t,e,r,o,i){void 0===i&&(i=Promise);var u=new S(s(t,e,r,o),i);return n.isGeneratorFunction(e)?u:u.next().then((function(n){return n.done?n.value:u.next()}))},x(k),a(k,c,"Generator"),k[i]=function(){return this},k.toString=function(){return"[object Generator]"},n.keys=function(n){var t=[];for(var e in n)t.push(e);return t.reverse(),function e(){for(;t.length;){var r=t.pop();if(r in n)return e.value=r,e.done=!1,e}return e.done=!0,e}},n.values=B,I.prototype={constructor:I,reset:function(n){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!n)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=t)},stop:function(){this.done=!0;var n=this.tryEntries[0].completion;if("throw"===n.type)throw n.arg;return this.rval},dispatchException:function(n){if(this.done)throw n;var e=this;function o(r,o){return c.type="throw",c.arg=n,e.next=r,o&&(e.method="next",e.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var u=this.tryEntries[i],c=u.completion;if("root"===u.tryLoc)return o("end");if(u.tryLoc<=this.prev){var a=r.call(u,"catchLoc"),s=r.call(u,"finallyLoc");if(a&&s){if(this.prev<u.catchLoc)return o(u.catchLoc,!0);if(this.prev<u.finallyLoc)return o(u.finallyLoc)}else if(a){if(this.prev<u.catchLoc)return o(u.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<u.finallyLoc)return o(u.finallyLoc)}}}},abrupt:function(n,t){for(var e=this.tryEntries.length-1;e>=0;--e){var o=this.tryEntries[e];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===n||"continue"===n)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var u=i?i.completion:{};return u.type=n,u.arg=t,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(u)},complete:function(n,t){if("throw"===n.type)throw n.arg;return"break"===n.type||"continue"===n.type?this.next=n.arg:"return"===n.type?(this.rval=this.arg=n.arg,this.method="return",this.next="end"):"normal"===n.type&&t&&(this.next=t),y},finish:function(n){for(var t=this.tryEntries.length-1;t>=0;--t){var e=this.tryEntries[t];if(e.finallyLoc===n)return this.complete(e.completion,e.afterLoc),D(e),y}},catch:function(n){for(var t=this.tryEntries.length-1;t>=0;--t){var e=this.tryEntries[t];if(e.tryLoc===n){var r=e.completion;if("throw"===r.type){var o=r.arg;D(e)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(n,e,r){return this.delegate={iterator:B(n),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=t),y}},n}(n.exports);try{regeneratorRuntime=t}catch(n){Function("r","regeneratorRuntime = r")(t)}}(p={exports:{}}),p.exports);function d(n){return n}function h(n){return y.apply(this,arguments)}function y(){return(y=i(f.mark((function n(t){var e;return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(t.status>=200&&t.status<300)){n.next=4;break}return n.abrupt("return",t.json());case 4:return e=new Error(t.statusText),n.next=7,t.json();case 7:throw e.response=n.sent,e;case 9:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function v(n,t){return _.apply(this,arguments)}function _(){return(_=i(f.mark((function n(t,e){var r,o,i,c,a,s,p;return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o=(r=e.couchDb).fetch,i=r.dbUrl,c=r.dbName,n.next=3,o(i+"/"+c+"/_all_docs?conflicts=true&include_docs=true",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({keys:t.map((function(n){return n._id}))})}).then(h).then((function(n){return n.rows.map((function(n){return n.doc})).filter((function(n){return!!n}))}));case 3:return a=n.sent,n.next=6,o(i+"/"+c+"/_bulk_get",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({docs:a.reduce((function(n,t){return[].concat(n,(t&&t._conflicts||[]).map((function(n){return{id:t._id,rev:n}})))}),[])})}).then(h).then((function(n){return n.results.map((function(n){return n.docs[0].ok})).filter((function(n){return!!n}))}));case 6:return s=n.sent,p=a.reduce((function(n,e){if(!n[e._id]){var r=a.find((function(n){return n._id===e._id}));n[e._id]={document:t.find((function(n){return n._id===e._id})),conflicts:[e],revToSave:r._rev}}var o,i=s.filter((function(n){return n._id===e._id}));return i?u({},n,((o={})[e._id]=u({},n[e._id],{conflicts:[].concat(n[e._id].conflicts,i)}),o)):n}),{}),n.abrupt("return",p);case 9:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function g(n,t){return w.apply(this,arguments)}function w(){return(w=i(f.mark((function n(t,e){var r,o,a,s,p,l,d,y,_,g,w;return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=(r=e.couchDb).fetch,a=r.dbName,s=r.dbUrl,l=r.onConflictsResolved,p=r.onResolveConflict){n.next=3;break}return n.abrupt("return",null);case 3:return n.next=5,v(t,e);case 5:return d=n.sent,n.next=8,Promise.all(Object.keys(d).map(function(){var n=i(f.mark((function n(t){var r,o;return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,p({document:d[t].document,conflicts:d[t].conflicts,context:e});case 2:if(!(r=n.sent)){n.next=6;break}return o=c(r,["_conflicts"]),n.abrupt("return",u({},o,{_rev:d[t].revToSave}));case 6:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}())).then((function(n){return n.filter(Boolean)}));case 8:return _=[].concat(y=n.sent,Object.keys(d).reduce((function(n,t){return[].concat(n,d[t].conflicts.map((function(n){return u({},n,{_deleted:!0})})).filter((function(n){return n._rev!==d[t].revToSave})))}),[])),n.next=12,o(s+"/"+a+"/_bulk_docs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({docs:_})}).then(h);case 12:return w=(g=n.sent).filter((function(n){return n.ok})).map((function(n){return u({},_.find((function(t){return t._id===n.id})),{_rev:n.rev,_id:n.id})})),l&&w.length>0&&l({documents:w,context:e}),n.abrupt("return",g.map((function(n,t){return u({},y[t],{_id:n.id,_rev:n.rev})})));case 16:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function b(n,t,e){return m.apply(this,arguments)}function m(){return(m=i(f.mark((function n(t,e,r){var o,c,a,s,p,l,d,y,v,_,w,b,m,k;return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(void 0===r&&(r={}),a=(c=t.couchDb).fetch,l=c.onDocumentsSaved,y=(d=r).upsert,_=void 0===(v=d.new_edits)||v,w=(s=c.dbUrl)+"/"+(p=c.dbName)+"/_bulk_docs",b=null!=(o=e._rev)?o:void 0,null===e._deleted&&delete e._deleted,!y){n.next=22;break}if(e._id){n.next=9;break}throw Error("upsert option requires input to contain _id");case 9:return n.prev=9,n.next=12,a(s+"/"+p+"/"+encodeURIComponent(e._id)).then(h);case 12:b=n.sent._rev,n.next=22;break;case 17:if(n.prev=17,n.t0=n.catch(9),n.t0._id=e._id,n.t0.response&&404===n.t0.response.status){n.next=22;break}throw n.t0;case 22:return n.next=24,a(w,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({docs:[u({},e,{_rev:b})],new_edits:_})}).then(h).then(function(){var n=i(f.mark((function n(r){var o,i;return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(o=Array.isArray(r)?r[0]:r)||!o.id||"conflict"!==o.error){n.next=8;break}return n.next=4,g([e],t);case 4:if(!(i=n.sent[0])){n.next=8;break}return n.abrupt("return",i);case 8:return n.abrupt("return",u({},e,{_id:o.id,_rev:o.rev}));case 9:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}()).catch((function(n){throw n.stack=(new Error).stack,n}));case 24:if(!(m=n.sent)||!m.error){n.next=29;break}throw(k=new Error(m.reason))._id=e._id,k;case 29:if(!m){n.next=34;break}return l&&l({documents:[m],context:t}),n.abrupt("return",m);case 34:return n.abrupt("return",null);case 35:case"end":return n.stop()}}),n,null,[[9,17]])})))).apply(this,arguments)}function k(){var n=a(["\n  type PutResponse {\n    _id: String!\n    _rev: String\n    document: JSON\n  }\n\n  extend type Mutation {\n    put(input: JSON, upsert: Boolean, new_edits: Boolean): PutResponse\n  }\n"]);return k=function(){return n},n}function x(n,t,e){return S.apply(this,arguments)}function S(){return(S=i(f.mark((function n(t,e,r){var o,c,a,s,p,l,d,y,v,_,w,b,m;return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(void 0===r&&(r={}),c=(o=t.couchDb).fetch,p=o.onDocumentsSaved,v=void 0===(y=(l=r).new_edits)||y,_=(a=o.dbUrl)+"/"+(s=o.dbName)+"/_bulk_docs",w={},!(d=l.upsert)){n.next=12;break}return b=e.map((function(n){return n._id})).filter((function(n){return!!n})),n.next=9,c(a+"/"+s+"/_all_docs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({keys:b})}).then(h);case 9:n.sent.data.rows.forEach((function(n){w[n.id]=n.value?n.value.rev:null}));case 12:return n.next=14,c(_,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({docs:e.map((function(n){var t,e=u({},n,{_rev:null!=(t=d&&n._id?w[n._id]:n._rev)?t:void 0});return null===e._deleted&&delete e._deleted,e})),new_edits:v})}).then(h).then(function(){var n=i(f.mark((function n(r){var o,i;return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!((o=r.filter((function(n){return"conflict"===n.error}))).length>0)){n.next=7;break}return n.next=4,g(e.filter((function(n){return o.find((function(t){return t.id===n._id}))})),t);case 4:if(!(i=n.sent)){n.next=7;break}return n.abrupt("return",r.map((function(n){var t=i.find((function(t){return t.id===n.id}));return"conflict"===n.error&&t?t:n})));case 7:return n.abrupt("return",r);case 8:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}()).catch((function(n){throw n.stack=(new Error).stack,n}));case 14:return m=n.sent.map((function(n,t){var r=e[t],o=n.error?w[r._id]||r._rev:n.rev;return{_id:n.id,_rev:o,error:n.error,reason:n.reason,document:u({},r,{_id:n.id,_rev:o})}})),p&&p({documents:m.filter((function(n){return!n.error})).map((function(n){return n.document})),context:t}),n.abrupt("return",m);case 18:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function O(){var n=a(["\n  type BulkDocsResponseObject {\n    _id: String\n    _rev: String\n    document: JSON\n    error: String\n    reason: String\n  }\n\n  extend type Mutation {\n    bulkDocs(\n      input: [JSON!]!\n      upsert: Boolean\n      new_edits: Boolean\n    ): [BulkDocsResponseObject]\n  }\n"]);return O=function(){return n},n}var N={__proto__:null,put:{__proto__:null,typeDefs:t.gql(k()),resolvers:{Mutation:{put:d(function(){var n=i(f.mark((function n(t,e,r,o){var i,u,c,a,s;return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=e.input,u=e.upsert,a=void 0===(c=e.new_edits)||c,n.next=3,b(r,i,{upsert:u,new_edits:a});case 3:return n.abrupt("return",{_id:(s=n.sent)._id,_rev:s._rev,document:s});case 5:case"end":return n.stop()}}),n)})));return function(t,e,r,o){return n.apply(this,arguments)}}())}}},bulkDocs:{__proto__:null,typeDefs:t.gql(O()),resolvers:{Mutation:{bulkDocs:d((function(n,t,e,r){var o=t.new_edits;return x(e,t.input,{upsert:t.upsert,new_edits:void 0===o||o})}))}}}};function D(n,t){return I.apply(this,arguments)}function I(){return(I=i(f.mark((function n(t,r){var o,i,u,a,s,p,l,d;return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=(o=void 0===r?{}:r).keys,u=o.key,a=o.endkey,s=o.startkey,p=c(o,["keys","key","endkey","startkey"]),l=t.couchDb.fetch,d=t.couchDb.dbUrl+"/"+t.couchDb.dbName+"/_all_docs",p&&(d+="?"+e.stringify(p)),n.next=6,l(d,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({keys:i,key:u,endkey:a,startkey:s})}).then(h).catch((function(n){throw n.stack=(new Error).stack,n}));case 6:return n.abrupt("return",n.sent);case 8:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function B(){var n=a(["\n  type AllDocsRow {\n    id: String!\n    rev: String\n    value: JSON\n    doc: JSON\n  }\n\n  type AllDocsResponse {\n    total_rows: Int!\n    offset: Int!\n    rows: [AllDocsRow!]!\n  }\n\n  extend type Query {\n    allDocs(\n      conflicts: Boolean\n      endkey: JSON\n      include_docs: Boolean\n      inclusive_end: Boolean\n      key: JSON\n      keys: [JSON!]\n      limit: Int\n      skip: Int\n      startkey: JSON\n      update_seq: Boolean\n    ): AllDocsResponse\n  }\n"]);return B=function(){return n},n}var E={__proto__:null,typeDefs:t.gql(B()),resolvers:{Query:{allDocs:d((function(n,t,e,r){return D(e,t)}))}}};function J(n,t,e){return j.apply(this,arguments)}function j(){return(j=i(f.mark((function n(t,r,o){var i,u,c,a;return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return c=(u=r.couchDb).fetch,a=u.dbUrl+"/"+u.dbName+"/_bulk_get",(i=(void 0===o?{}:o).revs)&&(a+="?"+e.stringify({revs:i})),n.next=6,c(a,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({docs:t,revs:i})}).then(h).catch((function(n){throw n.stack=(new Error).stack,n}));case 6:return n.abrupt("return",n.sent);case 8:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function R(){var n=a(["\n  input BulkGetInput {\n    id: String!\n    rev: String\n  }\n\n  type BulkGetResponse {\n    results: [BulkGetResult!]!\n  }\n\n  type BulkGetResult {\n    id: String\n    docs: [BulkGetDocs!]!\n  }\n\n  type BulkGetDocs {\n    ok: JSON\n    error: BulkGetError\n  }\n\n  type BulkGetError {\n    id: String\n    rev: String\n    error: String\n    reason: String\n  }\n\n  extend type Query {\n    bulkGet(docs: [BulkGetInput!]!, revs: Boolean): BulkGetResponse\n  }\n"]);return R=function(){return n},n}var q={__proto__:null,typeDefs:t.gql(R()),resolvers:{Query:{bulkGet:d((function(n,t,e,r){return J(t.docs,e,{revs:t.revs})}))}}};function T(n,t){return L.apply(this,arguments)}function L(){return(L=i(f.mark((function n(t,r){var o,i,u;return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o=t.couchDb.fetch,i=Object.keys(r).length>0,u=t+"/"+t+"/_changes",i&&(r.lastEventId&&(delete r.lastEventId,r["last-event-id"]=r.lastEventId),r.since&&"now"!==r.since&&(r.since=parseInt(r.since)),u+="?"+e.stringify(r)),n.next=6,o(u).then(h).catch((function(n){throw n.stack=(new Error).stack,n}));case 6:return n.abrupt("return",n.sent);case 8:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function C(){var n=a(["\n  type Change {\n    rev: String\n  }\n  type ChangesResult {\n    changes: [Change]\n    id: String\n    seq: JSON\n    doc: JSON\n    deleted: Boolean\n  }\n\n  type ChangesResponse {\n    last_seq: JSON\n    pending: Int\n    results: [ChangesResult]\n  }\n\n  extend type Query {\n    changes(\n      doc_ids: [String!]\n      conflicts: Boolean\n      descending: Boolean\n      feed: String\n      filter: String\n      heartbeat: Int\n      include_docs: Boolean\n      attachments: Boolean\n      att_encoding_info: Boolean\n      lastEventId: Int\n      limit: Int\n      since: String\n      timeout: Int\n      view: String\n      seq_interval: Int\n    ): ChangesResponse\n  }\n"]);return C=function(){return n},n}var G={__proto__:null,typeDefs:t.gql(C()),resolvers:{Query:{changes:d((function(n,t,e,r){return T(e,t)}))}}};function P(n,t){return Q.apply(this,arguments)}function Q(){return(Q=i(f.mark((function n(t,e){var r,o,i;return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o=(r=t.couchDb).fetch,i=r.dbUrl+"/"+r.dbName+"/_find",n.next=4,o(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(h).catch((function(n){throw n.stack=(new Error).stack,n}));case 4:return n.abrupt("return",n.sent);case 6:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function U(n,t,e){return A.apply(this,arguments)}function A(){return(A=i(f.mark((function n(t,r,o){var i,u,c,a,s,p;return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(void 0===o&&(o={}),u=(i=t.couchDb).fetch,c=i.dbUrl,a=i.dbName,s=Object.keys(o).length>0,r){n.next=5;break}throw new Error("id is undefined");case 5:return p=c+"/"+a+"/"+encodeURIComponent(r),s&&(p+="?"+e.stringify(o)),n.next=9,u(p).then(h).catch((function(n){throw n._id=r,n.stack=(new Error).stack,n}));case 9:return n.abrupt("return",n.sent);case 11:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function F(n){return M.apply(this,arguments)}function M(){return(M=i(f.mark((function n(t){var e,r,o;return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=(e=t.couchDb).fetch,o=e.dbUrl+"/"+e.dbName,n.next=4,r(o).then(h).catch((function(n){throw n.stack=(new Error).stack,n}));case 4:return n.abrupt("return",n.sent);case 6:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function z(n,t){return Y.apply(this,arguments)}function Y(){return(Y=i(f.mark((function n(t,r){var o,i,u,a,s,p,l,d,y,v,_;return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o=r.view,i=r.ddoc,u=r.key,a=r.keys,s=c(r,["view","ddoc","key","keys"]),l=(p=t.couchDb).fetch,d={key:u,keys:a},y=p.dbUrl+"/"+p.dbName+"/_design/"+i+"/_view/"+o,s&&(y+="?"+e.stringify(s)),v=Object.keys(d).length>0,_={},v&&(_.method="POST",_.body=JSON.stringify(d),_.headers={Accept:"application/json","Content-Type":"application/json"}),n.next=10,l(y,_).then(h).catch((function(n){throw n.stack=(new Error).stack,n}));case 10:return n.abrupt("return",n.sent);case 12:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function H(n,t){return K.apply(this,arguments)}function K(){return(K=i(f.mark((function n(t,e){var r,o,i,u,a,s;return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=e.index,o=e.ddoc,i=c(e,["index","ddoc"]),a=(u=t.couchDb).fetch,s=u.dbUrl+"/"+u.dbName+"/_design/"+o+"/_search/"+r,n.next=5,a(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)}).then(h).catch((function(n){throw n.stack=(new Error).stack,n}));case 5:return n.abrupt("return",n.sent);case 7:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function V(){return(V=i(f.mark((function n(t){var e,r,o;return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=(e=t.couchDb).fetch,o=e.dbUrl+"/"+e.dbName,n.next=4,r(o,{method:"PUT"}).then(h).catch((function(n){throw n.stack=(new Error).stack,n}));case 4:return n.abrupt("return",n.sent);case 6:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function W(){var n=a(["\n  type FindResponse {\n    execution_stats: JSON\n    bookmark: String\n    warning: String\n    docs: [JSON!]\n  }\n\n  extend type Query {\n    find(\n      selector: JSON!\n      limit: Int\n      skip: Int\n      sort: Int\n      fields: [String!]\n      use_index: [String!]\n      r: Int\n      bookmark: String\n      update: Boolean\n      stable: Boolean\n      stale: String\n      execution_stats: Boolean\n    ): FindResponse\n  }\n"]);return W=function(){return n},n}var X={__proto__:null,typeDefs:t.gql(W()),resolvers:{Query:{find:d((function(n,t,e,r){return P(e,t)}))}}};function Z(){var n=a(["\n  type GetResponse {\n    _id: String!\n    _rev: String\n    document: JSON\n  }\n\n  extend type Query {\n    get(\n      id: String!\n      rev: String\n      revs: Boolean\n      revs_info: Boolean\n      open_revs: Boolean\n      conflicts: Boolean\n      attachments: Boolean\n      latest: Boolean\n    ): GetResponse\n  }\n"]);return Z=function(){return n},n}var $={__proto__:null,typeDefs:t.gql(Z()),resolvers:{Query:{get:d(function(){var n=i(f.mark((function n(t,e,r,o){var i,u,a;return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=e.id,u=c(e,["id"]),n.next=3,U(r,i,u);case 3:return n.abrupt("return",{_id:(a=n.sent)._id,_rev:a._rev,document:a});case 5:case"end":return n.stop()}}),n)})));return function(t,e,r,o){return n.apply(this,arguments)}}())}}};function nn(){var n=a(["\n  type Sizes {\n    file: Int\n    external: Int\n    active: Int\n  }\n\n  type Other {\n    data_size: Int\n  }\n\n  type Cluster {\n    q: Int\n    n: Int\n    w: Int\n    r: Int\n  }\n\n  type InfoResponse {\n    db_name: String\n    update_seq: String\n    sizes: Sizes\n    purge_seq: Int\n    other: Other\n    doc_del_count: Int\n    doc_count: Int\n    disk_size: Int\n    disk_format_version: Int\n    data_size: Int\n    compact_running: Boolean\n    cluster: Cluster\n    instance_start_time: Int\n  }\n\n  extend type Query {\n    info: InfoResponse\n  }\n"]);return nn=function(){return n},n}var tn={__proto__:null,typeDefs:t.gql(nn()),resolvers:{Query:{info:d((function(n,t,e){return F(e)}))}}};function en(){var n=a(["\n  type QueryResponse {\n    offset: Int\n    update_seq: JSON\n    total_rows: Int\n    rows: [QueryRow!]\n  }\n\n  type QueryRow {\n    id: String\n    key: JSON\n    value: JSON\n  }\n\n  extend type Query {\n    query(\n      ddoc: String!\n      view: String!\n      conflicts: Boolean\n      descending: Boolean\n      endkey: JSON\n      group: Boolean\n      group_level: Int\n      include_docs: Boolean\n      attachments: Boolean\n      att_encoding_info: Boolean\n      inclusive_end: Boolean\n      key: JSON\n      keys: [JSON!]\n      limit: Int\n      reduce: Boolean\n      skip: Int\n      sorted: Boolean\n      stable: Boolean\n      stale: String\n      startkey: JSON\n      update: String\n      update_seq: Boolean\n    ): QueryResponse\n  }\n"]);return en=function(){return n},n}var rn={__proto__:null,typeDefs:t.gql(en()),resolvers:{Query:{query:d(function(){var n=i(f.mark((function n(t,e,r,o){return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",z(r,e));case 1:case"end":return n.stop()}}),n)})));return function(t,e,r,o){return n.apply(this,arguments)}}())}}};function on(){var n=a(["\n  type SearchResponse {\n    total_rows: Int!\n    bookmark: String!\n    rows: [SearchRow]!\n    counts: JSON\n  }\n\n  type SearchRow {\n    id: String!\n    order: [Int!]!\n    fields: JSON!\n    doc: JSON\n  }\n\n  extend type Query {\n    search(\n      index: String!\n      ddoc: String!\n      bookmark: String\n      counts: [String!]\n      drilldown: JSON\n      group_field: String\n      group_limit: Int\n      group_sort: JSON\n      highlight_fields: [String!]\n      highlight_pre_tag: String\n      highlight_post_tag: String\n      highlight_number: Int\n      highlight_size: Int\n      include_docs: Boolean\n      include_fields: [String!]\n      limit: Int\n      query: String!\n      ranges: JSON\n      sort: [String!]\n      stale: String\n    ): SearchResponse\n  }\n"]);return on=function(){return n},n}var un={__proto__:null,get:$,info:tn,bulkGet:q,changes:G,search:{__proto__:null,typeDefs:t.gql(on()),resolvers:{Query:{search:d(function(){var n=i(f.mark((function n(t,e,r,o){return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",H(r,e));case 1:case"end":return n.stop()}}),n)})));return function(t,e,r,o){return n.apply(this,arguments)}}())}}},find:X,query:rn,allDocs:E};exports.allDocs=D,exports.base=l,exports.bulkDocs=x,exports.bulkGet=J,exports.changes=T,exports.createContext=function(n){return{couchDb:u({fetch:fetch},n)}},exports.createCouchDbModule=function(n,t){var e=n.cloudant,o=c(n,["cloudant"]),i=c(un,["search"]),a=[l.typeDefs].concat(Object.keys(e?un:i).map((function(n){return un[n].typeDefs})),Object.keys(N).map((function(n){return N[n].typeDefs})));o.typeDefs&&(Array.isArray(o.typeDefs)?a.push.apply(a,o.typeDefs):a.push(o.typeDefs));var s=[].concat(Object.keys(e?un:i).map((function(n){return un[n].resolvers})),Object.keys(N).map((function(n){return N[n].resolvers})));return o.resolvers&&(Array.isArray(o.resolvers)?s.push.apply(s,o.resolvers):s.push(o.resolvers)),new r.GraphQLModule(u({},o,{typeDefs:a,resolvers:s}),t)},exports.createDb=function(n){return V.apply(this,arguments)},exports.createResolver=d,exports.find=P,exports.get=U,exports.info=F,exports.mutations=N,exports.put=b,exports.queries=un,exports.query=z,exports.resolveConflicts=g,exports.search=H;
//# sourceMappingURL=couchdb-graphql.cjs.production.min.js.map
