"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var n,e=require("apollo-server-core"),t=(n=require("qs"))&&"object"==typeof n&&"default"in n?n.default:n,r=require("@graphql-modules/core");function o(n,e,t,r,o,i,u){try{var s=n[i](u),a=s.value}catch(n){return void t(n)}s.done?e(a):Promise.resolve(a).then(r,o)}function i(n){return function(){var e=this,t=arguments;return new Promise((function(r,i){var u=n.apply(e,t);function s(n){o(u,r,i,s,a,"next",n)}function a(n){o(u,r,i,s,a,"throw",n)}s(void 0)}))}}function u(){return(u=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n}).apply(this,arguments)}function s(n,e){if(null==n)return{};var t,r,o={},i=Object.keys(n);for(r=0;r<i.length;r++)e.indexOf(t=i[r])>=0||(o[t]=n[t]);return o}function a(n,e){return e||(e=n.slice(0)),n.raw=e,n}function c(){var n=a(["\n    scalar JSON\n\n    type Query\n    type Mutation\n  "]);return c=function(){return n},n}require("isomorphic-fetch");var p,l={typeDefs:e.gql(c())},f=(function(n){var e=function(n){var e,t=Object.prototype,r=t.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",u=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function a(n,e,t){return Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}),n[e]}try{a({},"")}catch(n){a=function(n,e,t){return n[e]=t}}function c(n,e,t,r){var o=Object.create((e&&e.prototype instanceof v?e:v).prototype),i=new I(r||[]);return o._invoke=function(n,e,t){var r=l;return function(o,i){if(r===d)throw new Error("Generator is already running");if(r===h){if("throw"===o)throw i;return J()}for(t.method=o,t.arg=i;;){var u=t.delegate;if(u){var s=O(u,t);if(s){if(s===y)continue;return s}}if("next"===t.method)t.sent=t._sent=t.arg;else if("throw"===t.method){if(r===l)throw r=h,t.arg;t.dispatchException(t.arg)}else"return"===t.method&&t.abrupt("return",t.arg);r=d;var a=p(n,e,t);if("normal"===a.type){if(r=t.done?h:f,a.arg===y)continue;return{value:a.arg,done:t.done}}"throw"===a.type&&(r=h,t.method="throw",t.arg=a.arg)}}}(n,t,i),o}function p(n,e,t){try{return{type:"normal",arg:n.call(e,t)}}catch(n){return{type:"throw",arg:n}}}n.wrap=c;var l="suspendedStart",f="suspendedYield",d="executing",h="completed",y={};function v(){}function _(){}function g(){}var m={};m[i]=function(){return this};var b=Object.getPrototypeOf,x=b&&b(b(B([])));x&&x!==t&&r.call(x,i)&&(m=x);var w=g.prototype=v.prototype=Object.create(m);function S(n){["next","throw","return"].forEach((function(e){a(n,e,(function(n){return this._invoke(e,n)}))}))}function k(n,e){var t;this._invoke=function(o,i){function u(){return new e((function(t,u){!function t(o,i,u,s){var a=p(n[o],n,i);if("throw"!==a.type){var c=a.arg,l=c.value;return l&&"object"==typeof l&&r.call(l,"__await")?e.resolve(l.__await).then((function(n){t("next",n,u,s)}),(function(n){t("throw",n,u,s)})):e.resolve(l).then((function(n){c.value=n,u(c)}),(function(n){return t("throw",n,u,s)}))}s(a.arg)}(o,i,t,u)}))}return t=t?t.then(u,u):u()}}function O(n,t){var r=n.iterator[t.method];if(r===e){if(t.delegate=null,"throw"===t.method){if(n.iterator.return&&(t.method="return",t.arg=e,O(n,t),"throw"===t.method))return y;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return y}var o=p(r,n.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,y;var i=o.arg;return i?i.done?(t[n.resultName]=i.value,t.next=n.nextLoc,"return"!==t.method&&(t.method="next",t.arg=e),t.delegate=null,y):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,y)}function N(n){var e={tryLoc:n[0]};1 in n&&(e.catchLoc=n[1]),2 in n&&(e.finallyLoc=n[2],e.afterLoc=n[3]),this.tryEntries.push(e)}function D(n){var e=n.completion||{};e.type="normal",delete e.arg,n.completion=e}function I(n){this.tryEntries=[{tryLoc:"root"}],n.forEach(N,this),this.reset(!0)}function B(n){if(n){var t=n[i];if(t)return t.call(n);if("function"==typeof n.next)return n;if(!isNaN(n.length)){var o=-1,u=function t(){for(;++o<n.length;)if(r.call(n,o))return t.value=n[o],t.done=!1,t;return t.value=e,t.done=!0,t};return u.next=u}}return{next:J}}function J(){return{value:e,done:!0}}return _.prototype=w.constructor=g,g.constructor=_,_.displayName=a(g,s,"GeneratorFunction"),n.isGeneratorFunction=function(n){var e="function"==typeof n&&n.constructor;return!!e&&(e===_||"GeneratorFunction"===(e.displayName||e.name))},n.mark=function(n){return Object.setPrototypeOf?Object.setPrototypeOf(n,g):(n.__proto__=g,a(n,s,"GeneratorFunction")),n.prototype=Object.create(w),n},n.awrap=function(n){return{__await:n}},S(k.prototype),k.prototype[u]=function(){return this},n.AsyncIterator=k,n.async=function(e,t,r,o,i){void 0===i&&(i=Promise);var u=new k(c(e,t,r,o),i);return n.isGeneratorFunction(t)?u:u.next().then((function(n){return n.done?n.value:u.next()}))},S(w),a(w,s,"Generator"),w[i]=function(){return this},w.toString=function(){return"[object Generator]"},n.keys=function(n){var e=[];for(var t in n)e.push(t);return e.reverse(),function t(){for(;e.length;){var r=e.pop();if(r in n)return t.value=r,t.done=!1,t}return t.done=!0,t}},n.values=B,I.prototype={constructor:I,reset:function(n){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(D),!n)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=e)},stop:function(){this.done=!0;var n=this.tryEntries[0].completion;if("throw"===n.type)throw n.arg;return this.rval},dispatchException:function(n){if(this.done)throw n;var t=this;function o(r,o){return s.type="throw",s.arg=n,t.next=r,o&&(t.method="next",t.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var u=this.tryEntries[i],s=u.completion;if("root"===u.tryLoc)return o("end");if(u.tryLoc<=this.prev){var a=r.call(u,"catchLoc"),c=r.call(u,"finallyLoc");if(a&&c){if(this.prev<u.catchLoc)return o(u.catchLoc,!0);if(this.prev<u.finallyLoc)return o(u.finallyLoc)}else if(a){if(this.prev<u.catchLoc)return o(u.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<u.finallyLoc)return o(u.finallyLoc)}}}},abrupt:function(n,e){for(var t=this.tryEntries.length-1;t>=0;--t){var o=this.tryEntries[t];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===n||"continue"===n)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var u=i?i.completion:{};return u.type=n,u.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(u)},complete:function(n,e){if("throw"===n.type)throw n.arg;return"break"===n.type||"continue"===n.type?this.next=n.arg:"return"===n.type?(this.rval=this.arg=n.arg,this.method="return",this.next="end"):"normal"===n.type&&e&&(this.next=e),y},finish:function(n){for(var e=this.tryEntries.length-1;e>=0;--e){var t=this.tryEntries[e];if(t.finallyLoc===n)return this.complete(t.completion,t.afterLoc),D(t),y}},catch:function(n){for(var e=this.tryEntries.length-1;e>=0;--e){var t=this.tryEntries[e];if(t.tryLoc===n){var r=t.completion;if("throw"===r.type){var o=r.arg;D(t)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(n,t,r){return this.delegate={iterator:B(n),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=e),y}},n}(n.exports);try{regeneratorRuntime=e}catch(n){Function("r","regeneratorRuntime = r")(e)}}(p={exports:{}}),p.exports);function d(n){return n}function h(n){return y.apply(this,arguments)}function y(){return(y=i(f.mark((function n(e){var t;return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(e.status>=200&&e.status<300)){n.next=4;break}return n.abrupt("return",e.json());case 4:return t=new Error(e.statusText),n.next=7,e.json();case 7:throw t.response=n.sent,t;case 9:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function v(n,e){return _.apply(this,arguments)}function _(){return(_=i(f.mark((function n(e,t){var r,o,i,s,a,c,p;return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o=(r=t.couchDb).fetch,i=r.dbUrl,s=r.dbName,n.next=3,o(i+"/"+s+"/_all_docs?conflicts=true&include_docs=true",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({keys:e.map((function(n){return n._id}))})}).then(h).then((function(n){return n.rows.map((function(n){return n.doc})).filter((function(n){return!!n}))}));case 3:return a=n.sent,n.next=6,o(i+"/"+s+"/_bulk_get",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({docs:a.reduce((function(n,e){return[].concat(n,(e&&e._conflicts||[]).map((function(n){return{id:e._id,rev:n}})))}),[])})}).then(h).then((function(n){return n.results.map((function(n){return n.docs[0].ok})).filter((function(n){return!!n}))}));case 6:return c=n.sent,p=a.reduce((function(n,t){if(!n[t._id]){var r=a.find((function(n){return n._id===t._id}));n[t._id]={document:e.find((function(n){return n._id===t._id})),conflicts:[t],revToSave:r._rev}}var o,i=c.filter((function(n){return n._id===t._id}));return i?u({},n,((o={})[t._id]=u({},n[t._id],{conflicts:[].concat(n[t._id].conflicts,i)}),o)):n}),{}),n.abrupt("return",p);case 9:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function g(n,e){return m.apply(this,arguments)}function m(){return(m=i(f.mark((function n(e,t){var r,o,a,c,p,l,d,y,_,g,m;return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=(r=t.couchDb).fetch,a=r.dbName,c=r.dbUrl,l=r.onConflictsResolved,p=r.onResolveConflict){n.next=3;break}return n.abrupt("return",null);case 3:return n.next=5,v(e,t);case 5:return d=n.sent,n.next=8,Promise.all(Object.keys(d).map(function(){var n=i(f.mark((function n(e){var r,o;return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,p({document:d[e].document,conflicts:d[e].conflicts,context:t});case 2:if(!(r=n.sent)){n.next=6;break}return o=s(r,["_conflicts"]),n.abrupt("return",u({},o,{_rev:d[e].revToSave}));case 6:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}())).then((function(n){return n.filter(Boolean)}));case 8:return _=[].concat(y=n.sent,Object.keys(d).reduce((function(n,e){return[].concat(n,d[e].conflicts.map((function(n){return u({},n,{_deleted:!0})})).filter((function(n){return n._rev!==d[e].revToSave})))}),[])),n.next=12,o(c+"/"+a+"/_bulk_docs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({docs:_})}).then(h);case 12:return m=(g=n.sent).filter((function(n){return n.ok})).map((function(n){return u({},_.find((function(e){return e._id===n.id})),{_rev:n.rev,_id:n.id})})),l&&m.length>0&&l({documents:m,context:t}),n.abrupt("return",g.map((function(n,e){return u({},y[e],{_id:n.id,_rev:n.rev})})));case 16:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function b(n,e,t){return x.apply(this,arguments)}function x(){return(x=i(f.mark((function n(e,t,r){var o,s,a,c,p,l,d,y,v,_,m,b,x;return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(void 0===r&&(r={}),a=(s=e.couchDb).fetch,l=s.onDocumentsSaved,y=(d=r).upsert,_=void 0===(v=d.new_edits)||v,m=(c=s.dbUrl)+"/"+(p=s.dbName)+"/_bulk_docs",b=null!=(o=t._rev)?o:void 0,null===t._deleted&&delete t._deleted,!y){n.next=21;break}if(t._id){n.next=9;break}throw Error("upsert option requires input to contain _id");case 9:return n.prev=9,n.next=12,a(c+"/"+p+"/"+encodeURIComponent(t._id)).then(h);case 12:b=n.sent._rev,n.next=21;break;case 17:if(n.prev=17,n.t0=n.catch(9),n.t0.response&&404===n.t0.response.status){n.next=21;break}throw n.t0;case 21:return n.next=23,a(m,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({docs:[u({},t,{_rev:b})],new_edits:_})}).then(h).then(function(){var n=i(f.mark((function n(r){var o,i;return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(o=Array.isArray(r)?r[0]:r)||!o.id||"conflict"!==o.error){n.next=8;break}return n.next=4,g([t],e);case 4:if(!(i=n.sent[0])){n.next=8;break}return n.abrupt("return",i);case 8:return n.abrupt("return",u({},t,{_id:o.id,_rev:o.rev}));case 9:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}());case 23:if(!(x=n.sent)||!x.error){n.next=26;break}throw new Error(x.reason);case 26:if(!x){n.next=31;break}return l&&l({documents:[x],context:e}),n.abrupt("return",x);case 31:return n.abrupt("return",null);case 32:case"end":return n.stop()}}),n,null,[[9,17]])})))).apply(this,arguments)}function w(){var n=a(["\n  type PutResponse {\n    _id: String!\n    _rev: String\n    document: JSON\n  }\n\n  extend type Mutation {\n    put(input: JSON, upsert: Boolean, new_edits: Boolean): PutResponse\n  }\n"]);return w=function(){return n},n}function S(n,e,t){return k.apply(this,arguments)}function k(){return(k=i(f.mark((function n(e,t,r){var o,s,a,c,p,l,d,y,v,_,m,b,x;return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(void 0===r&&(r={}),s=(o=e.couchDb).fetch,p=o.onDocumentsSaved,v=void 0===(y=(l=r).new_edits)||y,_=(a=o.dbUrl)+"/"+(c=o.dbName)+"/_bulk_docs",m={},!(d=l.upsert)){n.next=12;break}return b=t.map((function(n){return n._id})).filter((function(n){return!!n})),n.next=9,s(a+"/"+c+"/_all_docs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({keys:b})}).then(h);case 9:n.sent.data.rows.forEach((function(n){m[n.id]=n.value?n.value.rev:null}));case 12:return n.next=14,s(_,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({docs:t.map((function(n){var e,t=u({},n,{_rev:null!=(e=d&&n._id?m[n._id]:n._rev)?e:void 0});return null===t._deleted&&delete t._deleted,t})),new_edits:v})}).then(h).then(function(){var n=i(f.mark((function n(r){var o,i;return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!((o=r.filter((function(n){return"conflict"===n.error}))).length>0)){n.next=7;break}return n.next=4,g(t.filter((function(n){return o.find((function(e){return e.id===n._id}))})),e);case 4:if(!(i=n.sent)){n.next=7;break}return n.abrupt("return",r.map((function(n){var e=i.find((function(e){return e.id===n.id}));return"conflict"===n.error&&e?e:n})));case 7:return n.abrupt("return",r);case 8:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}());case 14:return x=n.sent.map((function(n,e){var r=t[e],o=n.error?m[r._id]||r._rev:n.rev;return{_id:n.id,_rev:o,error:n.error,reason:n.reason,document:u({},r,{_id:n.id,_rev:o})}})),p&&p({documents:x.filter((function(n){return!n.error})).map((function(n){return n.document})),context:e}),n.abrupt("return",x);case 18:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function O(){var n=a(["\n  type BulkDocsResponseObject {\n    _id: String\n    _rev: String\n    document: JSON\n    error: String\n    reason: String\n  }\n\n  extend type Mutation {\n    bulkDocs(\n      input: [JSON!]!\n      upsert: Boolean\n      new_edits: Boolean\n    ): [BulkDocsResponseObject]\n  }\n"]);return O=function(){return n},n}var N={__proto__:null,put:{__proto__:null,typeDefs:e.gql(w()),resolvers:{Mutation:{put:d(function(){var n=i(f.mark((function n(e,t,r,o){var i,u,s,a,c;return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=t.input,u=t.upsert,a=void 0===(s=t.new_edits)||s,n.next=3,b(r,i,{upsert:u,new_edits:a});case 3:return n.abrupt("return",{_id:(c=n.sent)._id,_rev:c._rev,document:c});case 5:case"end":return n.stop()}}),n)})));return function(e,t,r,o){return n.apply(this,arguments)}}())}}},bulkDocs:{__proto__:null,typeDefs:e.gql(O()),resolvers:{Mutation:{bulkDocs:d((function(n,e,t,r){var o=e.new_edits;return S(t,e.input,{upsert:e.upsert,new_edits:void 0===o||o})}))}}}};function D(n,e){return I.apply(this,arguments)}function I(){return(I=i(f.mark((function n(e,r){var o,i,u,a,c,p,l,d;return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=(o=void 0===r?{}:r).keys,u=o.key,a=o.endkey,c=o.startkey,p=s(o,["keys","key","endkey","startkey"]),l=e.couchDb.fetch,d=e.couchDb.dbUrl+"/"+e.couchDb.dbName+"/_all_docs",p&&(d+="?"+t.stringify(p)),n.next=6,l(d,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({keys:i,key:u,endkey:a,startkey:c})}).then(h);case 6:return n.abrupt("return",n.sent);case 8:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function B(){var n=a(["\n  type AllDocsRow {\n    id: String!\n    rev: String\n    value: JSON\n    doc: JSON\n  }\n\n  type AllDocsResponse {\n    total_rows: Int!\n    offset: Int!\n    rows: [AllDocsRow!]!\n  }\n\n  extend type Query {\n    allDocs(\n      conflicts: Boolean\n      endkey: JSON\n      include_docs: Boolean\n      inclusive_end: Boolean\n      key: JSON\n      keys: [JSON!]\n      limit: Int\n      skip: Int\n      startkey: JSON\n      update_seq: Boolean\n    ): AllDocsResponse\n  }\n"]);return B=function(){return n},n}var J={__proto__:null,typeDefs:e.gql(B()),resolvers:{Query:{allDocs:d((function(n,e,t,r){return D(t,e)}))}}};function j(n,e,t){return R.apply(this,arguments)}function R(){return(R=i(f.mark((function n(e,r,o){var i,u,s,a;return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return s=(u=r.couchDb).fetch,a=u.dbUrl+"/"+u.dbName+"/_bulk_get",(i=(void 0===o?{}:o).revs)&&(a+="?"+t.stringify({revs:i})),n.next=6,s(a,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({docs:e,revs:i})}).then(h);case 6:return n.abrupt("return",n.sent);case 8:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function q(){var n=a(["\n  input BulkGetInput {\n    id: String!\n    rev: String\n  }\n\n  type BulkGetResponse {\n    results: [BulkGetResult!]!\n  }\n\n  type BulkGetResult {\n    id: String\n    docs: [BulkGetDocs!]!\n  }\n\n  type BulkGetDocs {\n    ok: JSON\n    error: BulkGetError\n  }\n\n  type BulkGetError {\n    id: String\n    rev: String\n    error: String\n    reason: String\n  }\n\n  extend type Query {\n    bulkGet(docs: [BulkGetInput!]!, revs: Boolean): BulkGetResponse\n  }\n"]);return q=function(){return n},n}var E={__proto__:null,typeDefs:e.gql(q()),resolvers:{Query:{bulkGet:d((function(n,e,t,r){return j(e.docs,t,{revs:e.revs})}))}}};function T(n,e){return L.apply(this,arguments)}function L(){return(L=i(f.mark((function n(e,r){var o,i,u;return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o=e.couchDb.fetch,i=Object.keys(r).length>0,u=e+"/"+e+"/_changes",i&&(r.lastEventId&&(delete r.lastEventId,r["last-event-id"]=r.lastEventId),r.since&&"now"!==r.since&&(r.since=parseInt(r.since)),u+="?"+t.stringify(r)),n.next=6,o(u).then(h);case 6:return n.abrupt("return",n.sent);case 8:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function C(){var n=a(["\n  type Change {\n    rev: String\n  }\n  type ChangesResult {\n    changes: [Change]\n    id: String\n    seq: JSON\n    doc: JSON\n    deleted: Boolean\n  }\n\n  type ChangesResponse {\n    last_seq: JSON\n    pending: Int\n    results: [ChangesResult]\n  }\n\n  extend type Query {\n    changes(\n      doc_ids: [String!]\n      conflicts: Boolean\n      descending: Boolean\n      feed: String\n      filter: String\n      heartbeat: Int\n      include_docs: Boolean\n      attachments: Boolean\n      att_encoding_info: Boolean\n      lastEventId: Int\n      limit: Int\n      since: String\n      timeout: Int\n      view: String\n      seq_interval: Int\n    ): ChangesResponse\n  }\n"]);return C=function(){return n},n}var G={__proto__:null,typeDefs:e.gql(C()),resolvers:{Query:{changes:d((function(n,e,t,r){return T(t,e)}))}}};function P(n,e){return Q.apply(this,arguments)}function Q(){return(Q=i(f.mark((function n(e,t){var r,o,i;return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o=(r=e.couchDb).fetch,i=r.dbUrl+"/"+r.dbName+"/_find",n.next=4,o(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(h);case 4:return n.abrupt("return",n.sent);case 6:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function U(n,e,t){return A.apply(this,arguments)}function A(){return(A=i(f.mark((function n(e,r,o){var i,u,s,a,c,p;return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return void 0===o&&(o={}),u=(i=e.couchDb).fetch,s=i.dbUrl,a=i.dbName,c=Object.keys(o).length>0,p=s+"/"+a+"/"+encodeURIComponent(r),c&&(p+="?"+t.stringify(o)),n.next=7,u(p).then(h);case 7:return n.abrupt("return",n.sent);case 9:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function F(n){return M.apply(this,arguments)}function M(){return(M=i(f.mark((function n(e){var t,r,o;return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=(t=e.couchDb).fetch,o=t.dbUrl+"/"+t.dbName,n.next=4,r(o).then(h);case 4:return n.abrupt("return",n.sent);case 6:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function z(n,e){return Y.apply(this,arguments)}function Y(){return(Y=i(f.mark((function n(e,r){var o,i,u,a,c,p,l,d,y,v,_;return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o=r.view,i=r.ddoc,u=r.key,a=r.keys,c=s(r,["view","ddoc","key","keys"]),l=(p=e.couchDb).fetch,d={key:u,keys:a},y=p.dbUrl+"/"+p.dbName+"/_design/"+i+"/_view/"+o,c&&(y+="?"+t.stringify(c)),v=Object.keys(d).length>0,_={},v&&(_.method="POST",_.body=JSON.stringify(d),_.headers={Accept:"application/json","Content-Type":"application/json"}),n.next=10,l(y,_).then(h);case 10:return n.abrupt("return",n.sent);case 12:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function H(n,e){return K.apply(this,arguments)}function K(){return(K=i(f.mark((function n(e,t){var r,o,i,u,a,c;return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.index,o=t.ddoc,i=s(t,["index","ddoc"]),a=(u=e.couchDb).fetch,c=u.dbUrl+"/"+u.dbName+"/_design/"+o+"/_search/"+r,n.next=5,a(c,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)}).then(h);case 5:return n.abrupt("return",n.sent);case 7:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function V(){return(V=i(f.mark((function n(e){var t,r,o;return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=(t=e.couchDb).fetch,o=t.dbUrl+"/"+t.dbName,n.next=4,r(o,{method:"PUT"}).then(h);case 4:return n.abrupt("return",n.sent);case 6:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function W(){var n=a(["\n  type FindResponse {\n    execution_stats: JSON\n    bookmark: String\n    warning: String\n    docs: [JSON!]\n  }\n\n  extend type Query {\n    find(\n      selector: JSON!\n      limit: Int\n      skip: Int\n      sort: Int\n      fields: [String!]\n      use_index: [String!]\n      r: Int\n      bookmark: String\n      update: Boolean\n      stable: Boolean\n      stale: String\n      execution_stats: Boolean\n    ): FindResponse\n  }\n"]);return W=function(){return n},n}var X={__proto__:null,typeDefs:e.gql(W()),resolvers:{Query:{find:d((function(n,e,t,r){return P(t,e)}))}}};function Z(){var n=a(["\n  type GetResponse {\n    _id: String!\n    _rev: String\n    document: JSON\n  }\n\n  extend type Query {\n    get(\n      id: String!\n      rev: String\n      revs: Boolean\n      revs_info: Boolean\n      open_revs: Boolean\n      conflicts: Boolean\n      attachments: Boolean\n      latest: Boolean\n    ): GetResponse\n  }\n"]);return Z=function(){return n},n}var $={__proto__:null,typeDefs:e.gql(Z()),resolvers:{Query:{get:d(function(){var n=i(f.mark((function n(e,t,r,o){var i,u,a;return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=t.id,u=s(t,["id"]),n.next=3,U(r,i,u);case 3:return n.abrupt("return",{_id:(a=n.sent)._id,_rev:a._rev,document:a});case 5:case"end":return n.stop()}}),n)})));return function(e,t,r,o){return n.apply(this,arguments)}}())}}};function nn(){var n=a(["\n  type Sizes {\n    file: Int\n    external: Int\n    active: Int\n  }\n\n  type Other {\n    data_size: Int\n  }\n\n  type Cluster {\n    q: Int\n    n: Int\n    w: Int\n    r: Int\n  }\n\n  type InfoResponse {\n    db_name: String\n    update_seq: String\n    sizes: Sizes\n    purge_seq: Int\n    other: Other\n    doc_del_count: Int\n    doc_count: Int\n    disk_size: Int\n    disk_format_version: Int\n    data_size: Int\n    compact_running: Boolean\n    cluster: Cluster\n    instance_start_time: Int\n  }\n\n  extend type Query {\n    info: InfoResponse\n  }\n"]);return nn=function(){return n},n}var en={__proto__:null,typeDefs:e.gql(nn()),resolvers:{Query:{info:d((function(n,e,t){return F(t)}))}}};function tn(){var n=a(["\n  type QueryResponse {\n    offset: Int\n    update_seq: JSON\n    total_rows: Int\n    rows: [QueryRow!]\n  }\n\n  type QueryRow {\n    id: String\n    key: JSON\n    value: JSON\n  }\n\n  extend type Query {\n    query(\n      ddoc: String!\n      view: String!\n      conflicts: Boolean\n      descending: Boolean\n      endkey: JSON\n      group: Boolean\n      group_level: Int\n      include_docs: Boolean\n      attachments: Boolean\n      att_encoding_info: Boolean\n      inclusive_end: Boolean\n      key: JSON\n      keys: [JSON!]\n      limit: Int\n      reduce: Boolean\n      skip: Int\n      sorted: Boolean\n      stable: Boolean\n      stale: String\n      startkey: JSON\n      update: String\n      update_seq: Boolean\n    ): QueryResponse\n  }\n"]);return tn=function(){return n},n}var rn={__proto__:null,typeDefs:e.gql(tn()),resolvers:{Query:{query:d(function(){var n=i(f.mark((function n(e,t,r,o){return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",z(r,t));case 1:case"end":return n.stop()}}),n)})));return function(e,t,r,o){return n.apply(this,arguments)}}())}}};function on(){var n=a(["\n  type SearchResponse {\n    total_rows: Int!\n    bookmark: String!\n    rows: [SearchRow]!\n    counts: JSON\n  }\n\n  type SearchRow {\n    id: String!\n    order: [Int!]!\n    fields: JSON!\n    doc: JSON\n  }\n\n  extend type Query {\n    search(\n      index: String!\n      ddoc: String!\n      bookmark: String\n      counts: [String!]\n      drilldown: JSON\n      group_field: String\n      group_limit: Int\n      group_sort: JSON\n      highlight_fields: [String!]\n      highlight_pre_tag: String\n      highlight_post_tag: String\n      highlight_number: Int\n      highlight_size: Int\n      include_docs: Boolean\n      include_fields: [String!]\n      limit: Int\n      query: String!\n      ranges: JSON\n      sort: [String!]\n      stale: String\n    ): SearchResponse\n  }\n"]);return on=function(){return n},n}var un={__proto__:null,get:$,info:en,bulkGet:E,changes:G,search:{__proto__:null,typeDefs:e.gql(on()),resolvers:{Query:{search:d(function(){var n=i(f.mark((function n(e,t,r,o){return f.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",H(r,t));case 1:case"end":return n.stop()}}),n)})));return function(e,t,r,o){return n.apply(this,arguments)}}())}}},find:X,query:rn,allDocs:J};exports.allDocs=D,exports.base=l,exports.bulkDocs=S,exports.bulkGet=j,exports.changes=T,exports.createContext=function(n){return{couchDb:u({fetch:fetch},n)}},exports.createCouchDbModule=function(n,e){var t=n.cloudant,o=s(n,["cloudant"]),i=s(un,["search"]),a=[l.typeDefs].concat(Object.keys(t?un:i).map((function(n){return un[n].typeDefs})),Object.keys(N).map((function(n){return N[n].typeDefs})));o.typeDefs&&(Array.isArray(o.typeDefs)?a.push.apply(a,o.typeDefs):a.push(o.typeDefs));var c=[].concat(Object.keys(t?un:i).map((function(n){return un[n].resolvers})),Object.keys(N).map((function(n){return N[n].resolvers})));return o.resolvers&&(Array.isArray(o.resolvers)?c.push.apply(c,o.resolvers):c.push(o.resolvers)),new r.GraphQLModule(u({},o,{typeDefs:a,resolvers:c}),e)},exports.createDb=function(n){return V.apply(this,arguments)},exports.createResolver=d,exports.find=P,exports.get=U,exports.info=F,exports.mutations=N,exports.put=b,exports.queries=un,exports.query=z,exports.resolveConflicts=g,exports.search=H;
//# sourceMappingURL=couchdb-graphql.cjs.production.min.js.map
